{{extends file="inc/base.html"}}

{{block body}}
<div class="frame">
    <div class="title">修改密码</div>
    <div class="container-fluid">
        <div class="panel panel-default">
            <div class="panel-body">
                <form onsubmit="return false;" class="form-horizontal">
                    <div class="form-group">
                        <label for="nickname" class="col-sm-2 control-label">账号</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="email" value="{{$user_info.email}}" readonly>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="nickname" class="col-sm-2 control-label">昵称</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="nickname" value="{{$user_info.nickname}}" readonly>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="nickname" class="col-sm-2 control-label">原密码</label>
                        <div class="col-sm-10">
                            <input type="password" class="form-control" id="ori_password">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="nickname" class="col-sm-2 control-label">新密码</label>
                        <div class="col-sm-10">
                            <input type="password" class="form-control" id="new_password">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="nickname" class="col-sm-2 control-label">重新输入密码</label>
                        <div class="col-sm-10">
                            <input type="password" class="form-control" id="re_new_password">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-10 text-center">
                            <button type="submit" id="submit" class="btn btn-primary"> 保存 </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{{/block}}

{{block "script"}}
<script>
    $(function () {
        $('#submit').click(function () {
            let data = {};
            data.ori_password = $('#ori_password').val();
            data.new_password = $('#new_password').val();
            data.re_new_password = $('#re_new_password').val();
            ajax('post', '{{APP_ADMIN_HOST}}/user/resetpassword', data, function (data) {
                if(data.code !== 2000000){
                    layer.msg(data.msg);
                    return false;
                }
                alert("密码修改成功，请重新登录");
                parent.window.location.reload();
            })
        });
    });
</script>
{{/block}}